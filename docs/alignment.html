<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8.5 Exercise Three: Alignment | GDSCN Book: SARS with Galaxy on AnVIL</title>
  <meta name="description" content="This book provides resources for instructors to engage students in a cloud-based Galaxy activity on AnVIL, focused on SARS-CoV-2 variant detection." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="8.5 Exercise Three: Alignment | GDSCN Book: SARS with Galaxy on AnVIL" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book provides resources for instructors to engage students in a cloud-based Galaxy activity on AnVIL, focused on SARS-CoV-2 variant detection." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8.5 Exercise Three: Alignment | GDSCN Book: SARS with Galaxy on AnVIL" />
  
  <meta name="twitter:description" content="This book provides resources for instructors to engage students in a cloud-based Galaxy activity on AnVIL, focused on SARS-CoV-2 variant detection." />
  



<meta name="date" content="2022-05-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/dasl_favicon.ico" type="image/x-icon" />
<link rel="prev" href="examining-fastq.html"/>
<link rel="next" href="view-alignment.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>




<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<a href="https://www.gdscn.org/"><img src="resources/images/gdscn_logo.png" style=" width: 80%; padding-left: 40px; padding-top: 24px; vertical-align: top "</a>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this Book</a>
<ul>
<li class="chapter" data-level="" data-path="anvil-collection.html"><a href="anvil-collection.html"><i class="fa fa-check"></i>AnVIL Collection</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="overview-and-learning-objectives.html"><a href="overview-and-learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Overview and Learning Objectives</a>
<ul>
<li class="chapter" data-level="1.1" data-path="activity-context.html"><a href="activity-context.html"><i class="fa fa-check"></i><b>1.1</b> Activity Context</a></li>
<li class="chapter" data-level="1.2" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1.2</b> Learning Objectives</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lesson-plan.html"><a href="lesson-plan.html"><i class="fa fa-check"></i><b>2</b> Lesson Plan</a></li>
<li class="part"><span><b>Background Lectures</b></span></li>
<li class="chapter" data-level="3" data-path="what-is-a-variant.html"><a href="what-is-a-variant.html"><i class="fa fa-check"></i><b>3</b> What Is a Variant?</a></li>
<li class="chapter" data-level="4" data-path="the-sequencing-revolution.html"><a href="the-sequencing-revolution.html"><i class="fa fa-check"></i><b>4</b> The Sequencing Revolution</a></li>
<li class="chapter" data-level="5" data-path="alignments.html"><a href="alignments.html"><i class="fa fa-check"></i><b>5</b> Alignments</a></li>
<li class="chapter" data-level="6" data-path="cloud-computing.html"><a href="cloud-computing.html"><i class="fa fa-check"></i><b>6</b> Cloud Computing</a></li>
<li class="part"><span><b>Lab Exercise Materials</b></span></li>
<li class="chapter" data-level="7" data-path="overview-video.html"><a href="overview-video.html"><i class="fa fa-check"></i><b>7</b> Overview Video</a></li>
<li class="chapter" data-level="8" data-path="student-activity-guide.html"><a href="student-activity-guide.html"><i class="fa fa-check"></i><b>8</b> Student Activity Guide</a>
<ul>
<li class="chapter" data-level="8.1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>8.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="introduction.html"><a href="introduction.html#before-you-start"><i class="fa fa-check"></i><b>8.1.1</b> Before You Start</a></li>
<li class="chapter" data-level="8.1.2" data-path="introduction.html"><a href="introduction.html#objectives"><i class="fa fa-check"></i><b>8.1.2</b> Objectives</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>8.2</b> Getting Started</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="getting-started.html"><a href="getting-started.html#set-up"><i class="fa fa-check"></i><b>8.2.1</b> Set Up</a></li>
<li class="chapter" data-level="8.2.2" data-path="getting-started.html"><a href="getting-started.html#starting-galaxy"><i class="fa fa-check"></i><b>8.2.2</b> Starting Galaxy</a></li>
<li class="chapter" data-level="8.2.3" data-path="getting-started.html"><a href="getting-started.html#navigating-galaxy"><i class="fa fa-check"></i><b>8.2.3</b> Navigating Galaxy</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>8.3</b> Exercise One: Importing Data into Galaxy</a></li>
<li class="chapter" data-level="8.4" data-path="examining-fastq.html"><a href="examining-fastq.html"><i class="fa fa-check"></i><b>8.4</b> Exercise Two: Examining <code>fastq</code> Files in Galaxy</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="examining-fastq.html"><a href="examining-fastq.html#examining-inputs"><i class="fa fa-check"></i><b>8.4.1</b> Examining Inputs</a></li>
<li class="chapter" data-level="8.4.2" data-path="examining-fastq.html"><a href="examining-fastq.html#quality-scoring"><i class="fa fa-check"></i><b>8.4.2</b> Quality Scoring</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="alignment.html"><a href="alignment.html"><i class="fa fa-check"></i><b>8.5</b> Exercise Three: Alignment</a></li>
<li class="chapter" data-level="8.6" data-path="view-alignment.html"><a href="view-alignment.html"><i class="fa fa-check"></i><b>8.6</b> Exercise Four: Viewing aligned data</a></li>
<li class="chapter" data-level="8.7" data-path="wrap-up.html"><a href="wrap-up.html"><i class="fa fa-check"></i><b>8.7</b> Wrap-up</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="register-and-solutions.html"><a href="register-and-solutions.html"><i class="fa fa-check"></i><b>A</b> Register and Solutions</a></li>
<li class="chapter" data-level="B" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>B</b> Help</a></li>
<li class="chapter" data-level="C" data-path="galaxy-training-network.html"><a href="galaxy-training-network.html"><i class="fa fa-check"></i><b>C</b> Galaxy Training Network</a></li>
<li class="chapter" data-level="D" data-path="download.html"><a href="download.html"><i class="fa fa-check"></i><b>D</b> Download</a></li>
<li class="chapter" data-level="E" data-path="give-us-feedback.html"><a href="give-us-feedback.html"><i class="fa fa-check"></i><b>E</b> Give Us Feedback</a></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the Authors</a></li>
<li class="divider"></li>
<a href="http://jhudatascience.org/"><img src="https://jhudatascience.org/images/dasl.png" style=" width: 80%; padding-left: 40px; padding-top: 8px; vertical-align: top "</a>       
<p style="text-align:center;"> <a href="https://github.com/jhudsl/DaSL_Course_Template_Bookdown" target="blank" > This content was published with</a> <a href="https://bookdown.org/" target="blank"> bookdown by:</a> </p>
<p style="text-align:center;"> <a href="http://jhudatascience.org/"> The Johns Hopkins Data Science Lab </a></p>
<p style="text-align:center; font-size: 12px;"> <a href="https://github.com/rstudio4edu/rstudio4edu-book/"> Style adapted from: rstudio4edu-book </a> <a href ="https://creativecommons.org/licenses/by/2.0/"> (CC-BY 2.0) </a></p>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GDSCN Book: SARS with Galaxy on AnVIL</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <!--script src="https://kit.fontawesome.com/6a26f47516.js"></script-->
  <!--<script src="assets/hideOutput.js"></script>-->
  <link href="assets/style_anvil.css" rel="stylesheet">
</head>
        


<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/dasl_thin_main_image.png">
</div>
<div id="alignment" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Exercise Three: Alignment</h2>
<p><em>Given that our data has passed some quality checks, we will try to align the data to the reference genome. In this case it is simple, a viral genome. A human sequencing project will generate much larger data sets. There are many aligners, but we will start off looking at a simple aligner BWA-MEM. This example uses paired data.</em></p>
<p>We will use our two SARs data files, which are ready for alignment.
<strong>VA_sample_forward_reads.fastq</strong>
<strong>VA_sample_reverse_reads.fastq</strong></p>
<p>Now go to GENOMICS ANALYSIS: Mapping and select “Map with BWA-MEM”. This program will align your reads to your SARS reference genome. Some of our reads are &gt;100 base pairs so we will use the MEM option.</p>
<p><img src="09-student-guide_files/figure-html/182AOzMaiyrreinnsRX2VhH7YsVgvAp4xtIB_7Mzmk6I_gf243efded1_0_33.png" title="Screenshot of the Tools pane in Galaxy. The &quot;Map with BWA-MEM&quot; link is highlighted." alt="Screenshot of the Tools pane in Galaxy. The &quot;Map with BWA-MEM&quot; link is highlighted." width="480" /></p>
<p>First, choose your reference. In the first drop down box change it to “Use a genome from history and build index”. Then choose the SARS reference <code>fasta</code> file that you uploaded as the reference.</p>
<p><img src="09-student-guide_files/figure-html/182AOzMaiyrreinnsRX2VhH7YsVgvAp4xtIB_7Mzmk6I_gf243efded1_0_41.png" title="Screenshot of the BWA-MEM tool options. The &quot;Use a genome from history and build index&quot; is selected and the reference fasta file has been selected from the drop down menu. Both of these are highlighted." alt="Screenshot of the BWA-MEM tool options. The &quot;Use a genome from history and build index&quot; is selected and the reference fasta file has been selected from the drop down menu. Both of these are highlighted." width="480" /></p>
<p>Under the “Single or Paired-end reads” ensure the “Paired” option is selected. Now choose your forward and reverse fastq files. Leave other options as-is. <em>You can learn more about what the alignment software BWA-MEM is doing if you scroll down below the execute button</em>. Click execute.</p>
<p><img src="09-student-guide_files/figure-html/182AOzMaiyrreinnsRX2VhH7YsVgvAp4xtIB_7Mzmk6I_gf243efded1_0_50.png" title="Screenshot of the BWA-MEM tool options. The following selections are highlighted: choice of single or paired-end reads (set to &quot;Paired&quot;), first set of reads (set to &quot;VA_sample_forward_reads.fastq&quot;), second set of reads (set to &quot;VA_sample_reverse_reads.fastq&quot;), and the &quot;Execute&quot; button." alt="Screenshot of the BWA-MEM tool options. The following selections are highlighted: choice of single or paired-end reads (set to &quot;Paired&quot;), first set of reads (set to &quot;VA_sample_forward_reads.fastq&quot;), second set of reads (set to &quot;VA_sample_reverse_reads.fastq&quot;), and the &quot;Execute&quot; button." width="480" /></p>
<p>The output file is a <code>BAM</code> file, which lists where each read aligns to the reference genome and whether there are any differences. You can click the eye button to preview the results, but the results are not easy to interpret visually (much like the <code>fastq</code> files). Instead you will use a genome viewer in the next step.</p>
<div class="fyi">
<p>QUESTIONS:</p>
<ol start="7" style="list-style-type: decimal">
<li><p>What is alignment software (for example, BWA-MEM) actually doing?</p></li>
<li><p>Here we are using paired fastq (“paired end”) data. What is an advantage of using paired data?</p></li>
</ol>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All illustrations <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY. </a>
      <br>
      All other materials <a href= "https://creativecommons.org/licenses/by/4.0/"> CC-BY </a> unless noted otherwise.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="examining-fastq.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="view-alignment.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jhudsl/GDSCN_Book_SARS_Galaxy_on_AnVIL/edit/main/09-student-guide.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
