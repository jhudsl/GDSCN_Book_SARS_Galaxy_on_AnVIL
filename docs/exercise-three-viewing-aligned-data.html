<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8.5 Exercise Three: Viewing aligned data | GDSCN Book: SARS with Galaxy on AnVIL</title>
  <meta name="description" content="This book provides resources for instructors to engage students in a cloud-based Galaxy activity on AnVIL, focused on SARS-CoV-2 variant detection." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="8.5 Exercise Three: Viewing aligned data | GDSCN Book: SARS with Galaxy on AnVIL" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book provides resources for instructors to engage students in a cloud-based Galaxy activity on AnVIL, focused on SARS-CoV-2 variant detection." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8.5 Exercise Three: Viewing aligned data | GDSCN Book: SARS with Galaxy on AnVIL" />
  
  <meta name="twitter:description" content="This book provides resources for instructors to engage students in a cloud-based Galaxy activity on AnVIL, focused on SARS-CoV-2 variant detection." />
  



<meta name="date" content="2022-04-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/dasl_favicon.ico" type="image/x-icon" />
<link rel="prev" href="exercise-two.html"/>
<link rel="next" href="wrap-up.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>




<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<a href="https://www.gdscn.org/"><img src="resources/images/gdscn_logo.png" style=" width: 80%; padding-left: 40px; padding-top: 24px; vertical-align: top "</a>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this Book</a></li>
<li class="chapter" data-level="1" data-path="overview-and-learning-objectives.html"><a href="overview-and-learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Overview and Learning Objectives</a>
<ul>
<li class="chapter" data-level="1.1" data-path="activity-context.html"><a href="activity-context.html"><i class="fa fa-check"></i><b>1.1</b> Activity Context</a></li>
<li class="chapter" data-level="1.2" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1.2</b> Learning Objectives</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lesson-plan.html"><a href="lesson-plan.html"><i class="fa fa-check"></i><b>2</b> Lesson Plan</a></li>
<li class="part"><span><b>Background Lectures</b></span></li>
<li class="chapter" data-level="3" data-path="what-is-a-variant.html"><a href="what-is-a-variant.html"><i class="fa fa-check"></i><b>3</b> What Is a Variant?</a></li>
<li class="chapter" data-level="4" data-path="the-sequencing-revolution.html"><a href="the-sequencing-revolution.html"><i class="fa fa-check"></i><b>4</b> The Sequencing Revolution</a></li>
<li class="chapter" data-level="5" data-path="alignments.html"><a href="alignments.html"><i class="fa fa-check"></i><b>5</b> Alignments</a></li>
<li class="chapter" data-level="6" data-path="cloud-computing.html"><a href="cloud-computing.html"><i class="fa fa-check"></i><b>6</b> Cloud Computing</a></li>
<li class="part"><span><b>Lab Exercise Materials</b></span></li>
<li class="chapter" data-level="7" data-path="overview-video.html"><a href="overview-video.html"><i class="fa fa-check"></i><b>7</b> Overview Video</a></li>
<li class="chapter" data-level="8" data-path="student-activity-guide.html"><a href="student-activity-guide.html"><i class="fa fa-check"></i><b>8</b> Student Activity Guide</a>
<ul>
<li class="chapter" data-level="8.1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>8.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="introduction.html"><a href="introduction.html#before-you-start"><i class="fa fa-check"></i><b>8.1.1</b> Before You Start</a></li>
<li class="chapter" data-level="8.1.2" data-path="introduction.html"><a href="introduction.html#objectives"><i class="fa fa-check"></i><b>8.1.2</b> Objectives</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>8.2</b> Getting Started</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="getting-started.html"><a href="getting-started.html#set-up"><i class="fa fa-check"></i><b>8.2.1</b> Set Up</a></li>
<li class="chapter" data-level="8.2.2" data-path="getting-started.html"><a href="getting-started.html#starting-galaxy"><i class="fa fa-check"></i><b>8.2.2</b> Starting Galaxy</a></li>
<li class="chapter" data-level="8.2.3" data-path="getting-started.html"><a href="getting-started.html#navigating-galaxy"><i class="fa fa-check"></i><b>8.2.3</b> Navigating Galaxy</a></li>
<li class="chapter" data-level="8.2.4" data-path="getting-started.html"><a href="getting-started.html#importing-data-into-galaxy"><i class="fa fa-check"></i><b>8.2.4</b> Importing Data into Galaxy</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="exercise-one-examining-fastq-files-in-galaxy.html"><a href="exercise-one-examining-fastq-files-in-galaxy.html"><i class="fa fa-check"></i><b>8.3</b> Exercise One: Examining <code>fastq</code> Files in Galaxy</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="exercise-one-examining-fastq-files-in-galaxy.html"><a href="exercise-one-examining-fastq-files-in-galaxy.html#examining-inputs"><i class="fa fa-check"></i><b>8.3.1</b> Examining Inputs</a></li>
<li class="chapter" data-level="8.3.2" data-path="exercise-one-examining-fastq-files-in-galaxy.html"><a href="exercise-one-examining-fastq-files-in-galaxy.html#quality-scoring"><i class="fa fa-check"></i><b>8.3.2</b> Quality Scoring</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="exercise-two.html"><a href="exercise-two.html"><i class="fa fa-check"></i><b>8.4</b> Exercise Two: Alignment</a></li>
<li class="chapter" data-level="8.5" data-path="exercise-three-viewing-aligned-data.html"><a href="exercise-three-viewing-aligned-data.html"><i class="fa fa-check"></i><b>8.5</b> Exercise Three: Viewing aligned data</a></li>
<li class="chapter" data-level="8.6" data-path="wrap-up.html"><a href="wrap-up.html"><i class="fa fa-check"></i><b>8.6</b> Wrap-up</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="register-and-solutions.html"><a href="register-and-solutions.html"><i class="fa fa-check"></i><b>A</b> Register and Solutions</a></li>
<li class="chapter" data-level="B" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>B</b> Help</a></li>
<li class="chapter" data-level="C" data-path="galaxy-training-network.html"><a href="galaxy-training-network.html"><i class="fa fa-check"></i><b>C</b> Galaxy Training Network</a></li>
<li class="chapter" data-level="D" data-path="download.html"><a href="download.html"><i class="fa fa-check"></i><b>D</b> Download</a></li>
<li class="chapter" data-level="E" data-path="give-us-feedback.html"><a href="give-us-feedback.html"><i class="fa fa-check"></i><b>E</b> Give Us Feedback</a></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the Authors</a></li>
<li class="divider"></li>
<a href="http://jhudatascience.org/"><img src="https://jhudatascience.org/images/dasl.png" style=" width: 80%; padding-left: 40px; padding-top: 8px; vertical-align: top "</a>       
<p style="text-align:center;"> <a href="https://github.com/jhudsl/DaSL_Course_Template_Bookdown" target="blank" > This content was published with</a> <a href="https://bookdown.org/" target="blank"> bookdown by:</a> </p>
<p style="text-align:center;"> <a href="http://jhudatascience.org/"> The Johns Hopkins Data Science Lab </a></p>
<p style="text-align:center; font-size: 12px;"> <a href="https://github.com/rstudio4edu/rstudio4edu-book/"> Style adapted from: rstudio4edu-book </a> <a href ="https://creativecommons.org/licenses/by/2.0/"> (CC-BY 2.0) </a></p>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GDSCN Book: SARS with Galaxy on AnVIL</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <!--script src="https://kit.fontawesome.com/6a26f47516.js"></script-->
  <!--<script src="assets/hideOutput.js"></script>-->
  <link href="assets/style_anvil.css" rel="stylesheet">
</head>
        


<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/dasl_thin_main_image.png">
</div>
<div id="exercise-three-viewing-aligned-data" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Exercise Three: Viewing aligned data</h2>
<p>We have aligned our data but it is currently a table of where the reads align. This is hard to read, so we will use JBrowse to view the data.</p>
<p>Go to STATISTICS AND VISUALIZATION: Graph/Display Data and select “JBrowse”. Under “Reference genome to display” ensure that “Use a genome from history” is selected. Below this, make sure that the <strong>SARS-CoV-2_reference_genome.fasta</strong> file is selected. Click “Execute”.</p>
<p><img src="09-student-guide_files/figure-html/182AOzMaiyrreinnsRX2VhH7YsVgvAp4xtIB_7Mzmk6I_gf243efded1_0_61.png" title="Screenshot of the JBrowse options in Galaxy. The JBrowse menu link is highlighted in the Tools pane. The following have also been highlighted: reference genome to display option (set to &quot;Use a genome from history&quot;), reference genome (set to &quot;SARS-CoV-2_reference_genome.fasta&quot;), and the &quot;Execute&quot; button." alt="Screenshot of the JBrowse options in Galaxy. The JBrowse menu link is highlighted in the Tools pane. The following have also been highlighted: reference genome to display option (set to &quot;Use a genome from history&quot;), reference genome (set to &quot;SARS-CoV-2_reference_genome.fasta&quot;), and the &quot;Execute&quot; button." width="480" /></p>
<p>You should see a new JBrowse item appear in your history. Click the eye icon (<img src="resources/images/eye.png" id="id" class="class" width="25" height="20" alt="eye button image" />) to open JBrowse. You will need to click on the magnifying glasses to zoom in, but you should see the A,C,G, and Ts and their corresponding colors that make up the SARS-CoV-2 genome!</p>
<p><img src="09-student-guide_files/figure-html/182AOzMaiyrreinnsRX2VhH7YsVgvAp4xtIB_7Mzmk6I_gf243efded1_0_72.png" title="Screenshot of preliminary JBrowse results. The eye icon is highlighted, as it should be used to open the JBrowse viewer. The magnifying glasses in JBrowse are also highlighted as they enable zooming in to see the individual bases." alt="Screenshot of preliminary JBrowse results. The eye icon is highlighted, as it should be used to open the JBrowse viewer. The magnifying glasses in JBrowse are also highlighted as they enable zooming in to see the individual bases." width="480" /></p>
<p>This is interesting, but it doesn’t let us compare the genome to the sample we have. We suspect there may be some differences that indicate our sample is the delta variant. Go back to STATISTICS AND VISUALIZATION: Graph/Display Data and select “JBrowse”. Just like before, under “Reference genome to display”, ensure that “Use a genome from history” is selected. Below this, make sure that the <strong>SARS-CoV-2_reference_genome.fasta</strong> file is selected.</p>
<p>This time, we’ll add our alignment data from <a href="exercise-two.html#exercise-two">Exercise Two</a>. Click the “+ Insert Track Group” button.</p>
<p><img src="09-student-guide_files/figure-html/182AOzMaiyrreinnsRX2VhH7YsVgvAp4xtIB_7Mzmk6I_gf243efded1_0_83.png" title="Screenshot of JBrowse options. The “+ Insert Track Group” button is highlighted." alt="Screenshot of JBrowse options. The “+ Insert Track Group” button is highlighted." width="480" /></p>
<p>Click “+ Insert Annotation Track” to add our alignment data.</p>
<p><img src="09-student-guide_files/figure-html/182AOzMaiyrreinnsRX2VhH7YsVgvAp4xtIB_7Mzmk6I_gf243efded1_0_92.png" title="Screenshot of JBrowse options. The “+ Insert Annotation Track” button is highlighted." alt="Screenshot of JBrowse options. The “+ Insert Annotation Track” button is highlighted." width="480" /></p>
<p>You’ll keep everything the same except the following:</p>
<ul>
<li><strong>Track Type</strong>: BAM Pileups</li>
<li><strong>Autogenerate SNP Track</strong>: Yes</li>
<li><strong>Maximum size of BAM chunks</strong>: Add one more zero: 50000000</li>
</ul>
<p><img src="09-student-guide_files/figure-html/182AOzMaiyrreinnsRX2VhH7YsVgvAp4xtIB_7Mzmk6I_gf243efded1_0_99.png" title="Screenshot of JBrowse options. The following options are highlighted: Track type (set to &quot;BAM Pileups&quot;), Autogenerate SNP Track (set to &quot;Yes&quot;), and Maximum size of BAM chunks (set to 50000000)." alt="Screenshot of JBrowse options. The following options are highlighted: Track type (set to &quot;BAM Pileups&quot;), Autogenerate SNP Track (set to &quot;Yes&quot;), and Maximum size of BAM chunks (set to 50000000)." width="480" /></p>
<p>These arguments tell JBrowse what kind of data we are using, as well as some memory options. Click “Execute”.</p>
<p>You should see a new JBrowse item appear in your history. Click the eye icon (<img src="resources/images/eye.png" id="id" class="class" width="25" height="20" alt="eye button image" />) to open JBrowse. Make sure that all boxes are checked on the left side: “Available Tracks”. Note that the tracks show up in the order that you click on them.</p>
<p><img src="09-student-guide_files/figure-html/182AOzMaiyrreinnsRX2VhH7YsVgvAp4xtIB_7Mzmk6I_gfa95c9e4ef_0_20.png" title="Screenshot of JBrowse viewer. The Available Tracks sidebar is shown, with both sample data boxes checked." alt="Screenshot of JBrowse viewer. The Available Tracks sidebar is shown, with both sample data boxes checked." width="480" /></p>
<p>Let’s look at an example mutation in our sample. Type in the reference position “24410” and click “Go”. You should see a bunch of “A”s highlighted in green throughout our sample. The reference sequence (top line) is a “G” but all of the reads are an “A”. This means that our sample is genetically different from the established SARS-CoV-2 reference genome! Researchers often call these single base differences “SNPs” - Single Nucleotide Polymorphisms.</p>
<p><img src="09-student-guide_files/figure-html/182AOzMaiyrreinnsRX2VhH7YsVgvAp4xtIB_7Mzmk6I_gf243efded1_0_109.png" title="Screenshot of JBrowse viewer at base 24410 in the genome. The search bar has been highlighted and shows that 24410 has been entered. A SNP has been highlighted indicating a shift from G to A. The SNP is readily visible because it is a different color (green)." alt="Screenshot of JBrowse viewer at base 24410 in the genome. The search bar has been highlighted and shows that 24410 has been entered. A SNP has been highlighted indicating a shift from G to A. The SNP is readily visible because it is a different color (green)." width="480" /></p>
<div class="fyi">
<p>QUESTIONS:</p>
<ol start="9" style="list-style-type: decimal">
<li><p>How long is the SARS-CoV-2 genome? Hint: zoom out and scroll to the end of the genome.</p></li>
<li><p>Locate position 23,603. This is the site of an important mutation in the spike protein of the delta variant “P681R”. In this mutation, the amino acid proline is replaced by arginine. Is this mutation present at position 23,603 in our sample? Based on the evidence, do you think this sample is a delta variant?</p></li>
</ol>
</div>
<div class="fyi">
<p><strong>Breakout Box: Sequencing errors</strong></p>
<p>It’s possible to make mistakes in the data preparation before we get to the data analysis. Sometimes this happens when the samples are being prepared in the lab and sometimes this happens because the sequencer makes a mistake. This is one reason why quality scores are helpful. With millions of reads of data, it’s more likely that we see a “SNP” that is actually an accident. Multiple copies of the same areas of our data (“read depth”) help us be sure it’s a real SNP. When we compare across lots of aligned reads of the same area, we can determine the actual sequence by consensus. For example, we can be reasonably confident that the “G” at position 1,203 shown below is just a sequencing or lab mistake.</p>
<p><img src="09-student-guide_files/figure-html/182AOzMaiyrreinnsRX2VhH7YsVgvAp4xtIB_7Mzmk6I_gf243efded1_0_127.png" title="Screenshot of JBrowse viewer at base 1203 in the genome. A single base in a single read has been highlighted indicating a shift in that read to a G. This difference is not likely to represent the sample as a whole." alt="Screenshot of JBrowse viewer at base 1203 in the genome. A single base in a single read has been highlighted indicating a shift in that read to a G. This difference is not likely to represent the sample as a whole." width="480" /></p>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All illustrations <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY. </a>
      <br>
      All other materials <a href= "https://creativecommons.org/licenses/by/4.0/"> CC-BY </a> unless noted otherwise.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="exercise-two.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="wrap-up.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jhudsl/GDSCN_Book_SARS_Galaxy_on_AnVIL/edit/main/09-student-guide.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
